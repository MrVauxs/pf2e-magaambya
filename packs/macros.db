{"command":"// For quick addition of the Student of the Magaambya feat to multiple selected tokens at once.\n\nconst actors = canvas.tokens.controlled.flatMap((token) => token.actor ?? []);\nif (actors.length === 0 && game.user.character) actors.push(game.user.character);\nif (actors.length === 0) {\n    const message = game.i18n.localize(\"PF2E.ErrorMessage.NoTokenSelected\");\n    return ui.notifications.error(message);\n}\n\nconst ITEM_UUID = \"Compendium.pf2e-magaambya.Feats.K653qXggMJdFmBnp\"; // Student of the Magaambya\nconst source = (await fromUuid(ITEM_UUID)).toObject();\nsource.flags = mergeObject(source.flags ?? {}, { core: { sourceId: ITEM_UUID } });\n\nfor (const actor of actors) {\n    const existing = actor.items.find((e) => e.flags.core?.sourceId === ITEM_UUID);\n    if (existing) {\n        return ui.notifications.error(\"You already have this item!\");\n    } else {\n        await actor.createEmbeddedDocuments(\"Item\", [source]);\n    }\n}","name":"Student of the Magaambya","type":"script","img":"icons/sundries/scrolls/scroll-bound-leather-tan.webp","author":"SCUQoZ7lvePPTab6","scope":"global","ownership":{"default":0,"SCUQoZ7lvePPTab6":3},"flags":{"advanced-macros":{"runAsGM":false,"runForEveryone":false,"runForSpecificUser":""},"core":{"sourceId":"Macro.PTGMlPeY9Wp33lh7"}},"_stats":{"systemId":"pf2e","systemVersion":"4.4.2","coreVersion":"10.291","createdTime":1670281462698,"modifiedTime":1670288029894,"lastModifiedBy":"SCUQoZ7lvePPTab6"},"folder":null,"sort":0,"_id":"BTu5181aPfsEoz8D"}
